<!DOCTYPE html>

<head>
  <title>Courses</title>

  <style>
	* { font-family: sans-serif; cursor: default }
	main { display: flex }
	section { flex: 50% }
	ul { margin: 0 }
	
	#selected { background: lightyellow }
	#options  { background: lightcyan }
  </style>

  <script>
	const url = "https://gist.githubusercontent.com/alaindebecker/99b90565149df879de2c4f9c52f0278a/raw/de57bdcabf92017c01c7950f509d720000e4229a/courses.dat"

	onload = function(){
		x = new XMLHttpRequest()
		x.open("GET", url)
		x.onload = function(){
			toHTML(x.response)
		}
		x.send()
	}
	
	toHTML = function(txt){
		category = ""
		options = ""
		selected = ""
		for(line of txt.split(/\r?\n/)){
			if(m=line.match(/^\s*([\+\-])\s*(.*)/))
				options += '<li class="'+category+'"onmousedown="startdrag(event)">'+m[2]+'</li>'
			else {
				category = line.toLowerCase().replace(/[^0-9a-z]/g, '_')
				selected += '</ul></details><details open><summary>'+line+'</summary><ul class="'+category+'">'
				options  += '</ul></details><details><summary>'+line+'</summary><ul class="'+category+'">'
			}
		}
		document.querySelector("#options").innerHTML  =  options.substring(5+10)
		document.querySelector("#selected").innerHTML = selected.substring(5+10)
	}
	
	drag = null
	startdrag = function(evt){
		evt.preventDefault()
		drag = evt.target.cloneNode(true)
		evt.target.parentElement.parentElement.parentElement.append(drag)
		drag.style.position = "absolute"
		drag.style.left = evt.target.getBoundingClientRect().left +'px'
		drag.style.top  = evt.target.getBoundingClientRect().top +'px'
	}
	onmousemove = function(evt){
		if(!drag) return
		drag.style.left = evt.clientX +'px'
		drag.style.top  = evt.clientY +'px'
	}
	onmouseup = function(evt){
		if(!drag) return
		console.log(drag.parentElement.id)
		x = document.querySelector("#selected ul."+drag.className)
		drag.style.position = "static"
		x.append(drag)
		drag = null
	}
  </script>
</head>

<body>
  <main>
	<section id="selected"></section>
	<section id="options"></section>
  </main>
</body>
</html>
